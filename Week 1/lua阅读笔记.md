# 语法笔记



## 变量
1. 未使用local规定的变量都是全局变量

2. 局部变量的的作用域是从声明位置开始到语句块结束。

> lua整个文件相当于一个大的语句块，如果直接在文件中定义的局部变量，则其到文件的结束都是其作用范围。

3. 除了循环语句，函数语句，do - end也是语句块的一种

4. 在赋值语句中Lua会先计算右侧所有值，然后再将右侧的值执行赋值操作，因此可以实现直接交换变量
> x, y = y, x                     -- swap 'x' for 'y'

> 基于特性3，可以知道 a , b = 0 , 1;<br>
> a, b = a + 1, a + 1;   -----> 1 ， 1 <br>
> 因为Lua会优先计算右侧值，每次计算的时候a的取值均为0，然后得到1后再赋值


当左右值数量不一致时:
+ 多余变量补nil
+ 多余值被忽略

## 循环

lua有三种循环 while .. do .. end; for .. do .. end; repeat .. until;

lua没有continue，但是可以使用goto完成实现continue功能，或者多写一个if判断

for 循环语句的条件表达式有三项，分别为初始值，终止条件，步进值
+ 初始条件必须指定，不能使用外部的变量
    + 初始条件是一个外部索引，在循环体内部修改不会影响i的值
+ 终止条件是<=，即到达终止条件还需要进行一次。
    + 终止条件还可以使用函数，但函数只会在启动循环前执行一次
    + 函数的参数和for的起始条件相互隔离，即使同名，也是不同变量，且外部需要特别定义一个变量用于终止条件
+ 步进值不指定默认为1

在泛型遍历中有两种遍历方式pairs和ipairs
+ pairs可以遍历所有的key，直到table内容被遍历后再结束
+ ipairs只遍历key为数字的table元素，且当元素的值为nil时会直接结束遍历
    > tab = { key1 = "val1", key2 = "val2" } ipairs不会遍历<br>
    > {tab = {1,2,a= nil,nil,"d"}} 中a = nil会被跳过，且当遇到后一个nil时会推出循环，不会遍历"d"


## 条件表达式

false 和 nil 属于false 数字 0 属于 true

## Lua函数

由于Lua基于C和C++实现，函数可以作为参数进行传递

函数参数列表中，可以使用`...`表示函数有可变参数

select可以用于计算lua变长参数的数量计算，以及返回从一组参数

select(n, ...)表示从返回从第n个数往后的所有数据，返回的是单个值，而不是一个table集合

> arg = select(2, 'one', 'two', 'three', 'four', 'five')  <br>
> print(arg)  --> two

函数可以有多个返回值，当多个函数作为赋值语句的右值时，只有最后一个函数会被展开
> function add() return 1, 0 end <br>
> local b, c, d, e = add(), add() <br>
> b --> 1, c --> 1 , d --> 0, e -->nil


## 运算符

**(有问题)**

'#'运算符可以计算字符串和table长度，但对table进行计算时
其计算长度时根据key索引数值进行计算，且计算方法是二分查询
> {1, nil, 3,nil, 4} --> 
[参考] (https://www.runoob.com/w3cnote/lua-table-length-analysis.html)
