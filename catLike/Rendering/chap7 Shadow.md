# 阴影

## 级联阴影

级联阴影仅在使用平行光的时候会出现，因为平行光没有固定位置，无论离摄像机距离远或近都需要检测是否有阴影。

+ 如果从很远渲染一张阴影贴图，那么每个纹素的实际物理范围可能很大。那么摄像机近处的阴影精度就会不足。
+ 如果从很近渲染阴影贴图，那么较远处可能就没阴影。

因此一般级联阴影会有四份，用于确定到底是否需要显式对应的阴影。

## 处理阴影痤疮

阴影痤疮的产生原因是因为，阴影贴图中每个纹素代表光照射到表面的点，但是这点可能覆盖范围很大，且其是与光线方向一致，并非是表面的方向。

这导致它们可能像黑色碎片般嵌入、穿透或突出表面。当部分纹素从投射阴影的表面刺出时，表面看似在自我投影，这种现象被称为阴影痤疮。

![alt text](<chap7 Shadow/image.png>)

处理方法有两种，
+ 一种是直接对阴影应用偏移量，让阴影远离物体。但是这样的会出现物体和阴影分离
+ 一种在编写Shader时，采样阴影的时候，让物体的片段沿着法线正方向偏移一定距离，从而让保证阴影不会刺出物体表面。

## 阴影翻转

采样的到的阴影可能的结果可能会和图形API是反方向，因此需要根据图形API进行变化。