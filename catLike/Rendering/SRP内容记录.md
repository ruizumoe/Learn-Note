# 着色函数

## 顶点着色器：

将每个三角形顶点数据传入（对象空间）进行计算，转化为在屏幕空间上的三个顶点。 此过程可以定义返回值类型，返回值的如果有以下类型会再片元着色器中根据重心坐标进行插值。

![Alt text](SRP%E5%86%85%E5%AE%B9%E8%AE%B0%E5%BD%95/image.png)

也就是说顶点着色器的调用一次一般比片元着色器更少


## 片元着色器：

片元着色器会基于光栅化化后的每个像素位置，计算出其在三角形中的重心坐标，然后自动将顶点着色器返回的三个返回值进行重心插值。找出当前像素对应的输入。

> 片元着色器的输入，一定是一个插值结果。

1. 此时片元着色器的输入，我们可以获取表面的信息进行提取。由于信息都是保存在材质中的。因此可以直接通过插值得到的UV信息，对材质进行采样。从而获得表面数据信息（Surface结构体）
2. 在获得表面信息以后，可以根据表面性质获取其对光的描述特性BRDF数据。
3. 在获取BRDF以后，可以通过输入光照贴图，表面信息，和BRDF数据，计算出当前片元的全局光照信息Gi。
    1. Gi会包含当前光照的强度信息、高光信息，以及当前烘焙阴影贴图信息
4. 在获取全局光照和brdf以后，根据表面计算其应该使用的颜色数据
    1. 首先根据其表面数据，获取实时光源的阴影信息以及烘焙阴影遮罩
    2. 获得非直接光的全局光照下等到的基础颜色
    3. 遍历所有直接关于，计算其在直接光实时光照和烘焙光下获得颜色
    4. 遍历所有非直接光，计算其在实时光照、烘焙光和阴影作用下的颜色